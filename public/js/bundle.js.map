{"version":3,"sources":["index.js"],"names":["videoArea","document","querySelector","videoSelect","profilePicCanvas","profilePictureOutput","takePicButton","videoTag","width","height","streaming","addEventListener","e","takeProfilePic","preventDefault","context","getContext","drawImage","data","toDataURL","setAttribute","videoHeight","videoWidth","isNaN","constraints","audio","video","mandatory","minWidth","maxWidth","minHeight","maxHeight","navigator","mediaDevices","enumerateDevices","then","devices","i","length","device","kind","option","createElement","value","deviceId","text","label","appendChild","startStream","getUserMedia","stream","console","log","srcObject","play","catch","error"],"mappings":"AAAA,IAAMA,SAAS,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAlB;AACA,IAAMC,WAAW,GAAGF,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAApB;AACA,IAAME,gBAAgB,GAAGH,QAAQ,CAACC,aAAT,CAAuB,mBAAvB,CAAzB;AACA,IAAMG,oBAAoB,GAAGJ,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAA7B;AACA,IAAMI,aAAa,GAAGL,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,CAAtB;AACA,IAAMK,QAAQ,GAAGN,QAAQ,CAACC,aAAT,CAAuB,WAAvB,CAAjB;AAEA,IAAIM,KAAK,GAAG,GAAZ;AAAA,IACEC,MAAM,GAAG,CADX;AAAA,IAEEC,SAAS,GAAG,KAFd,EAIA;;AAEAJ,aAAa,CAACK,gBAAd,CACE,OADF,EAEE,UAAAC,CAAC,EAAI;AACHC,EAAAA,cAAc;AACdD,EAAAA,CAAC,CAACE,cAAF;AACD,CALH,EAME,KANF;;AASA,SAASD,cAAT,GAA0B;AACxB,MAAIE,OAAO,GAAGX,gBAAgB,CAACY,UAAjB,CAA4B,IAA5B,CAAd;;AACA,MAAIR,KAAK,IAAIC,MAAb,EAAqB;AACnBL,IAAAA,gBAAgB,CAACI,KAAjB,GAAyBA,KAAzB;AACAJ,IAAAA,gBAAgB,CAACK,MAAjB,GAA0BA,MAA1B;AACAM,IAAAA,OAAO,CAACE,SAAR,CAAkBV,QAAlB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkCC,KAAlC,EAAyCC,MAAzC;AAEA,QAAIS,IAAI,GAAGd,gBAAgB,CAACe,SAAjB,CAA2B,WAA3B,CAAX;AACAd,IAAAA,oBAAoB,CAACe,YAArB,CAAkC,KAAlC,EAAyCF,IAAzC;AACD;AACF,EAED;;;AAEAX,QAAQ,CAACI,gBAAT,CACE,SADF,EAEE,UAASC,CAAT,EAAY;AACV,MAAI,CAACF,SAAL,EAAgB;AACdD,IAAAA,MAAM,GAAGF,QAAQ,CAACc,WAAT,IAAwBd,QAAQ,CAACe,UAAT,GAAsBd,KAA9C,CAAT;;AAEA,QAAIe,KAAK,CAACd,MAAD,CAAT,EAAmB;AACjBA,MAAAA,MAAM,GAAGD,KAAK,IAAI,IAAI,CAAR,CAAd;AACD;;AAEDD,IAAAA,QAAQ,CAACa,YAAT,CAAsB,OAAtB,EAA+BZ,KAA/B;AACAD,IAAAA,QAAQ,CAACa,YAAT,CAAsB,QAAtB,EAAgCX,MAAhC;AACAL,IAAAA,gBAAgB,CAACgB,YAAjB,CAA8B,OAA9B,EAAuCZ,KAAvC;AACAJ,IAAAA,gBAAgB,CAACgB,YAAjB,CAA8B,QAA9B,EAAwCX,MAAxC;AACAC,IAAAA,SAAS,GAAG,IAAZ;AACD;AACF,CAhBH,EAiBE,KAjBF;AAoBA,IAAIc,WAAW,GAAG;AAChBC,EAAAA,KAAK,EAAE,IADS;AAEhBC,EAAAA,KAAK,EAAE;AACLC,IAAAA,SAAS,EAAE;AACTC,MAAAA,QAAQ,EAAE,GADD;AAETC,MAAAA,QAAQ,EAAE,GAFD;AAGTC,MAAAA,SAAS,EAAE,GAHF;AAITC,MAAAA,SAAS,EAAE;AAJF;AADN;AAFS,CAAlB;AAYAC,SAAS,CAACC,YAAV,CAAuBC,gBAAvB,GAA0CC,IAA1C,CAA+C,UAASC,OAAT,EAAkB;AAC/D,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,OAAO,CAACE,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACvC,QAAIE,MAAM,GAAGH,OAAO,CAACC,CAAD,CAApB;;AACA,QAAIE,MAAM,CAACC,IAAP,KAAgB,YAApB,EAAkC;AAChC,UAAIC,MAAM,GAAGxC,QAAQ,CAACyC,aAAT,CAAuB,QAAvB,CAAb;AACAD,MAAAA,MAAM,CAACE,KAAP,GAAeJ,MAAM,CAACK,QAAtB;AACAH,MAAAA,MAAM,CAACI,IAAP,GAAcN,MAAM,CAACO,KAAP,IAAgB,aAAaT,CAAC,GAAG,CAAjB,CAA9B;AACApC,MAAAA,QAAQ,CAACC,aAAT,CAAuB,oBAAvB,EAA6C6C,WAA7C,CAAyDN,MAAzD;AACD;AACF;AACF,CAVD;AAWAtC,WAAW,CAACQ,gBAAZ,CAA6B,OAA7B,EAAsC,UAAAC,CAAC,EAAI;AACzCoC,EAAAA,WAAW;AACZ,CAFD;;AAIA,SAASA,WAAT,GAAuB;AACrBhB,EAAAA,SAAS,CAACC,YAAV,CACGgB,YADH,CACgBzB,WADhB,EAEGW,IAFH,CAEQ,UAAAe,MAAM,EAAI;AACdC,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AAEApD,IAAAA,SAAS,CAACqD,SAAV,GAAsBH,MAAtB;AACAlD,IAAAA,SAAS,CAACsD,IAAV;AACD,GAPH,EAQGC,KARH,CAQS,UAAAC,KAAK,EAAI;AACdL,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCI,KAAzC;AACD,GAVH;AAWD","file":"bundle.js","sourceRoot":"","sourcesContent":["const videoArea = document.querySelector(\"video\");\r\nconst videoSelect = document.querySelector(\"#videoSource\");\r\nconst profilePicCanvas = document.querySelector(\"#profilePicCanvas\");\r\nconst profilePictureOutput = document.querySelector(\"#profilePictureOutput\");\r\nconst takePicButton = document.querySelector(\"#takeProfilePicture\");\r\nconst videoTag = document.querySelector(\"#videoTag\");\r\n\r\nlet width = 240,\r\n  height = 0,\r\n  streaming = false;\r\n\r\n// Picture\r\n\r\ntakePicButton.addEventListener(\r\n  \"click\",\r\n  e => {\r\n    takeProfilePic();\r\n    e.preventDefault();\r\n  },\r\n  false\r\n);\r\n\r\nfunction takeProfilePic() {\r\n  let context = profilePicCanvas.getContext(\"2d\");\r\n  if (width && height) {\r\n    profilePicCanvas.width = width;\r\n    profilePicCanvas.height = height;\r\n    context.drawImage(videoTag, 0, 0, width, height);\r\n\r\n    let data = profilePicCanvas.toDataURL(\"image/png\");\r\n    profilePictureOutput.setAttribute(\"src\", data);\r\n  }\r\n}\r\n\r\n// Video\r\n\r\nvideoTag.addEventListener(\r\n  \"canplay\",\r\n  function(e) {\r\n    if (!streaming) {\r\n      height = videoTag.videoHeight / (videoTag.videoWidth / width);\r\n\r\n      if (isNaN(height)) {\r\n        height = width / (4 / 3);\r\n      }\r\n\r\n      videoTag.setAttribute(\"width\", width);\r\n      videoTag.setAttribute(\"height\", height);\r\n      profilePicCanvas.setAttribute(\"width\", width);\r\n      profilePicCanvas.setAttribute(\"height\", height);\r\n      streaming = true;\r\n    }\r\n  },\r\n  false\r\n);\r\n\r\nlet constraints = {\r\n  audio: true,\r\n  video: {\r\n    mandatory: {\r\n      minWidth: 240,\r\n      maxWidth: 240,\r\n      minHeight: 240,\r\n      maxHeight: 240\r\n    }\r\n  }\r\n};\r\n\r\nnavigator.mediaDevices.enumerateDevices().then(function(devices) {\r\n  for (let i = 0; i < devices.length; i++) {\r\n    let device = devices[i];\r\n    if (device.kind === \"videoinput\") {\r\n      let option = document.createElement(\"option\");\r\n      option.value = device.deviceId;\r\n      option.text = device.label || \"camera \" + (i + 1);\r\n      document.querySelector(\"select#videoSource\").appendChild(option);\r\n    }\r\n  }\r\n});\r\nvideoSelect.addEventListener(\"input\", e => {\r\n  startStream();\r\n});\r\n\r\nfunction startStream() {\r\n  navigator.mediaDevices\r\n    .getUserMedia(constraints)\r\n    .then(stream => {\r\n      console.log(\"Success! We have a stream\");\r\n\r\n      videoArea.srcObject = stream;\r\n      videoArea.play();\r\n    })\r\n    .catch(error => {\r\n      console.log(\"Error with getUserMedia: \", error);\r\n    });\r\n}\r\n"]}